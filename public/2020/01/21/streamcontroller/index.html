<!DOCTYPE html>
<html prefix="og: http://ogp.me/ns#">
    <head>
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <title>Dart Streamcontroller - Streams and stuff &middot; Mubasser Kamal</title>
        <meta name="description" content="BLoC Pattern  BLoC stands for Business Logic Components  Data Layer - The data layer is responsible for the app’s models and the connections to the back-end, it knows nothing about about the UI.
The BLoC Pattern is really just an interface around Dart streams: Streams, like Futures, are provided by the dart:async package
 A stream is like a Future, but instead of returning a single value asynchronously, streams can yield multiple values over time  First BLoC Create a new directory in the lib folder named BLoC.">
        <meta name="HandheldFriendly" content="True">
        <meta name="MobileOptimized" content="320">
        <meta name="generator" content="Hugo 0.62.2" />
        <meta name="robots" content="index,follow">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <meta property="og:title" content="Dart Streamcontroller - Streams and stuff">
<meta property="og:description" content="BLoC Pattern  BLoC stands for Business Logic Components  Data Layer - The data layer is responsible for the app’s models and the connections to the back-end, it knows nothing about about the UI.
The BLoC Pattern is really just an interface around Dart streams: Streams, like Futures, are provided by the dart:async package
 A stream is like a Future, but instead of returning a single value asynchronously, streams can yield multiple values over time  First BLoC Create a new directory in the lib folder named BLoC.">
<meta property="og:type" content="article">
<meta property="og:url" content="/2020/01/21/streamcontroller/">
		<link rel="stylesheet" href="css/dracula.css" rel="stylesheet" id="theme-stylesheet">
		<script src="js/highlight.pack.js"></script>
		<script>hljs.initHighlightingOnLoad();</script>
        <link rel="stylesheet" href="dist/styles.css">
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:300italic,400italic,600italic,700italic,400,600,700,300&subset=latin,cyrillic-ext,latin-ext,cyrillic">
        <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css" integrity="sha384-wvfXpqpZZVQGK6TAh5PVlGOfQNHSoD2xbE+QkPxCAFlNEevoEH3Sl0sibVcOQVnN" crossorigin="anonymous">
        
        
        
        
    </head>
    <body>
        

        <div id="wrapper">
            <header class="site-header">
                <div class="container">
                    <div class="site-title-wrapper">
                        
                            <h1 class="site-title">
                                <a title="Mobu&#39;s Journal" href="">Mobu&#39;s Journal</a>
                            </h1>
                        
                        <a class="button-square" href="index.xml"><i class="fa fa-rss"></i></a>
                        
                        
                        
                        
                            <a class="button-square button-social hint--top" data-hint="Github" title="Github" href="https://github.com/mobu" rel="me">
                                <i class="fa fa-github-alt"></i>
                            </a>
                        
                        
                        
                        
                        
                    </div>

                    <ul class="site-nav">
                        
    <li class="site-nav-item">
        <a title="Blog" href="../../../../">Blog</a>
    </li>

    <li class="site-nav-item">
        <a title="Contact" href="../../../../page/contact/">Contact</a>
    </li>

    <li class="site-nav-item">
        <a title="About" href="../../../../page/about/">About</a>
    </li>

                    </ul>
                </div>
            </header>

            <div id="container">

<div class="container">
    <article class="post-container" itemscope="" itemtype="http://schema.org/BlogPosting">
        <header class="post-header">
    <h1 class="post-title" itemprop="name headline">Dart Streamcontroller - Streams and stuff</h1>
    
    <p class="post-date post-line">
        <span>Published <time datetime="2020-01-21" itemprop="datePublished">Tue, Jan 21, 2020</time></span>
        <span>by</span>
        <span itemscope="" itemprop="author" itemtype="https://schema.org/Person">
            <span itemprop="name">
                <a href="#" itemprop="url" rel="author">Mubasser Kamal</a>
            </span>
        </span>
    </p>
    
</header>

        <div class="post-content clearfix" itemprop="articleBody">
    

    <h1 id="bloc-pattern">BLoC Pattern</h1>
<ul>
<li>BLoC stands for Business Logic Components</li>
</ul>
<p><strong>Data Layer</strong> - The data layer is responsible for the app’s models and the connections to the back-end, it knows nothing about about the UI.</p>
<p><img src="../../../../img/03-BLoC-layers-1.png" alt="BLoC Layers" title="BLoC Layers"></p>
<p>The BLoC Pattern is really just an interface around Dart <strong>streams</strong>:
<img src="../../../../img/04-BLoC-diagram-1-650x284.png" alt="BLoC Diagram" title="BLoC Diagram"></p>
<p>Streams, like Futures, are provided by the <code>dart:async</code> package</p>
<ul>
<li>A stream is like a Future, but instead of returning a single value
asynchronously, streams can yield multiple values over time</li>
</ul>
<h2 id="first-bloc">First BLoC</h2>
<p>Create a new directory in the <strong>lib</strong> folder named <strong>BLoC</strong>. This will be the home for all your BLoC classes.</p>
<ul>
<li>lib
<ul>
<li>BLoC</li>
</ul>
</li>
</ul>
<p><strong>Dispose Streams</strong> - One small caveat that needs to be kept in mind with streams is that they need to be closed when they are no longer needed, otherwise it can cause a memory leak.</p>
<pre><code>final _locationController = StreamController&lt;*Location*&gt;();
</code></pre>
<ul>
<li>Here a private <code>StreamController</code> is declared that will manage the stream and sink for this BLoC. <code>StreamController</code>s use generics to tell the type system what kind of object will be emitted from the stream.</li>
</ul>
<h2 id="future--stream-dart">Future &amp; Stream (Dart)</h2>
<p><strong>Future</strong> - A Future represents a computation that doesn’t complete immediately. Where a normal function returns the result, an asynchronous function returns a Future, which will eventually contain the result. The future will tell you when the result is ready.</p>
<p><strong>Stream</strong> - A stream is a sequence of asynchronous events. It is like an asynchronous Iterable—where, instead of getting the next event when you ask for it, the stream tells you that there is an event when it is ready.</p>
<ul>
<li><strong>Consuming a stream</strong>: Data is sent out of a stream to a StreamSubscriber (or possibly multiple subscribers).</li>
<li><strong>Populating a stream</strong>: Data gets into a stream from a StreamController.</li>
</ul>
<h3 id="how-to-create-a-stream">How to create a Stream</h3>
<div class="highlight"><pre class="chroma"><code class="language-dart" data-lang="dart"><span class="n">StreamController</span><span class="o">&lt;</span><span class="kt">double</span><span class="o">&gt;</span> <span class="n">controller</span> <span class="o">=</span> <span class="n">StreamController</span><span class="o">&lt;</span><span class="kt">double</span><span class="o">&gt;</span><span class="p">(</span><span class="p">)</span><span class="p">;</span>
</code></pre></div><p>The next thing to do is to be able to get the values from a stream. This is commonly referred to as subscribing or listening to a stream.</p>
<div class="highlight"><pre class="chroma"><code class="language-dart" data-lang="dart"><span class="n">stream</span><span class="p">.</span><span class="n">listen</span><span class="p">(</span><span class="p">(</span><span class="n">value</span><span class="p">)</span> <span class="p">{</span>
  <span class="n">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="s1">Value from controller: </span><span class="si">$</span><span class="n">value</span><span class="s1">&#39;</span><span class="p">)</span><span class="p">;</span>
<span class="p">}</span><span class="p">)</span><span class="p">;</span>
</code></pre></div><p>The way you emit a value over a stream is by calling add on the streams controller.</p>
<ul>
<li>The listen call returns a <strong>StreamSubscription</strong> of the type of your
stream. This can be used to manage the stream subscription.</li>
</ul>
<div class="highlight"><pre class="chroma"><code class="language-dart" data-lang="dart"><span class="n">controller</span><span class="p">.</span><span class="n">add</span><span class="p">(</span><span class="m">12</span><span class="p">)</span><span class="p">;</span>
</code></pre></div><h3 id="single-subscription-streams">Single-subscription Streams</h3>
<p>This type of Stream only allows a <strong>single</strong> listener during the whole lifetime of that Stream.</p>
<blockquote>
<p>It is not possible to listen twice on such Stream, even after the first subscription has been canceled.</p>
</blockquote>
<h3 id="broadcast-streams">Broadcast Streams</h3>
<p>This second type of Stream allows <strong>any number</strong> of listeners.</p>
<blockquote>
<p>It is possible to add a listener to a Broadcast Stream at any moment. The new listener will receive the events, as of the moment it starts listening to the Stream.
import &lsquo;dart:async&rsquo;;</p>
</blockquote>
<h2 id="business-logic-component">Business Logic Component</h2>
<p>In short, the <strong>Business Logic</strong> needs to:</p>
<ul>
<li>be moved to one or several <em>BLoC</em> s</li>
<li>be removed as much as possible from the Presentation Layer. In other words, UI components should only worry about the UI things and not about the business</li>
<li>rely on exclusive use of Streams for both input (Sink) and output (stream)</li>
<li>remain platform independent</li>
<li>remain environment independent.</li>
</ul>
<p>Helpful YouTube URL:
<a href="https://www.youtube.com/watch?v=NCJZ_T8FiUo">https://www.youtube.com/watch?v=NCJZ_T8FiUo</a></p>
<div class="highlight"><pre class="chroma"><code class="language-dart" data-lang="dart"><span class="k">import</span> <span class="s1">&#39;</span><span class="s1">dart:async</span><span class="s1">&#39;</span><span class="p">;</span>

<span class="kd">class</span> <span class="nc">JustDataBloc</span> <span class="p">{</span>
  <span class="c1">//This is the Stream that streams Just Data.
</span><span class="c1"></span>
  <span class="c1">//Controller of this Stream.
</span><span class="c1"></span>  <span class="kd">var</span> <span class="n">_justDataController</span> <span class="o">=</span> <span class="n">StreamController</span><span class="o">&lt;</span><span class="kt">String</span><span class="o">&gt;</span><span class="p">.</span><span class="n">broadcast</span><span class="p">(</span><span class="p">)</span><span class="p">;</span>

  <span class="c1">//Function to feed Data.
</span><span class="c1"></span>  <span class="n">Function</span><span class="p">(</span><span class="kt">String</span><span class="p">)</span> <span class="kd">get</span> <span class="n">feedJustData</span> <span class="o">=</span><span class="o">&gt;</span> <span class="n">_justDataController</span><span class="p">.</span><span class="n">sink</span><span class="p">.</span><span class="n">add</span><span class="p">;</span>

  <span class="c1">//Stream to output the Data
</span><span class="c1"></span>  <span class="n">Stream</span><span class="o">&lt;</span><span class="kt">String</span><span class="o">&gt;</span> <span class="kd">get</span> <span class="n">streamJustData</span> <span class="o">=</span><span class="o">&gt;</span> <span class="n">_justDataController</span><span class="p">.</span><span class="n">stream</span><span class="p">;</span>

  <span class="n">dispose</span><span class="p">(</span><span class="p">)</span> <span class="p">{</span>
    <span class="c1">//Dispose Stream to avoid memory leak.
</span><span class="c1"></span>    <span class="n">_justDataController</span><span class="o">?</span><span class="p">.</span><span class="n">close</span><span class="p">(</span><span class="p">)</span><span class="p">;</span>
  <span class="p">}</span>
<span class="p">}</span>

<span class="c1">//Global Variable for this Stream.
</span><span class="c1"></span><span class="n">JustDataBloc</span> <span class="n">justDataBloc</span> <span class="o">=</span> <span class="n">JustDataBloc</span><span class="p">(</span><span class="p">)</span><span class="p">;</span>
</code></pre></div>
</div>

        <footer class="post-footer clearfix">
    

    <div class="share">
        
            <a class="icon-twitter" href="https://twitter.com/share?text=Dart%20Streamcontroller%20-%20Streams%20and%20stuff&url=%2f2020%2f01%2f21%2fstreamcontroller%2f"
                onclick="window.open(this.href, 'twitter-share', 'width=550,height=235');return false;">
                <i class="fa fa-twitter"></i>
                <span class="hidden">Twitter</span>
            </a>
        

        
            <a class="icon-facebook" href="https://www.facebook.com/sharer/sharer.php?u=%2f2020%2f01%2f21%2fstreamcontroller%2f"
                onclick="window.open(this.href, 'facebook-share','width=580,height=296');return false;">
                <i class="fa fa-facebook"></i>
                <span class="hidden">Facebook</span>
            </a>
        

        
            <a class="icon-google-plus" href="https://plus.google.com/share?url=%2f2020%2f01%2f21%2fstreamcontroller%2f"
              onclick="window.open(this.href, 'google-plus-share', 'width=490,height=530');return false;">
              <i class="fa fa-google-plus"></i>
                <span class="hidden">Google+</span>
            </a>
        
        
    </div>
</footer>

        
    </article>
</div>

            </div>
        </div>

        <footer class="footer">
            <div class="container">
                <div class="site-title-wrapper">
                    <h1 class="site-title">
                        <a title="Mobu&#39;s Journal" href="">Mobu&#39;s Journal</a>
                    </h1>
                    <a class="button-square button-jump-top js-jump-top" href="#">
                        <i class="fa fa-angle-up"></i>
                    </a>
                </div>

                <p class="footer-copyright">
                    <span>&copy; 2020 / Powered by <a href="https://gohugo.io/">Hugo</a></span>
                </p>
                <p class="footer-copyright">
                    <span><a href="https://github.com/roryg/ghostwriter">Ghostwriter theme</a> By <a href="http://jollygoodthemes.com">JollyGoodThemes</a></span>
                    <span>/ <a href="https://github.com/jbub/ghostwriter">Ported</a> to Hugo By <a href="https://github.com/jbub">jbub</a></span>
                </p>
            </div>
        </footer>

        <script src="js/jquery-1.11.3.min.js"></script>
        <script src="js/jquery.fitvids.js"></script>
        
        
            <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/highlight.min.js"></script>
        
        
        <script src="js/scripts.js"></script>
    </body>
</html>

